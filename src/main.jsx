"use strict";

// from http://wikiotics.org/es/Family1?view=resource_json
var resource_json = {"dividers": "4,8,12", "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-19T00:34:16.516966", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard_deck", "interactions": {"array": [{"href": "urn:sha384:pNSfgxJLItN3tAYODCkzV3O56_wRfJvUHY-V3oq8SlAccrGXBhw5pOUa9sllGUC9", "resource": {"answer": "1", "prompt": "0,2", "fqn": "{http://wikiotics.org/ns/2011/flashcards}choice_interaction"}}]}, "headings": {"array": [{"text": "Text"}, {"text": "Picture"}, {"text": "Audio"}]}, "tags": {"array": [{"value": "ps9"}, {"value": "family"}, {"value": "target-language:es"}]}, "cards": {"array": [{"href": "urn:sha384:Sg1ozdDy27nVOB5RY6n8ujg7NqJdmoACBFtu-x_F9P3NG7oT4VA4PZVYA3rqY8z1", "resource": {"sides": {"array": [{"href": "urn:sha384:sEZp5d_UH2WUBZeV9mX7DchAs_V0FhOhfaDjHwmZLp0X3IDGWbzMSbzJEvMNvRTs", "resource": {"phrase": {"text": "Es el hijo."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:RVujccu_X3mIoBa6QFVWBiLrNlp_E45ENoupvTZcCnpNuqwU9UGfUKxI2u6VYqHy", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/44398680@N08/"}, "author": {"text": "Afghanistan Matters (AfghanistanMatters)"}, "original_url": {"href": "http://www.flickr.com/photos/44398680@N08/4271545190"}, "title": {"text": "Boy"}}, "blob": {"href": "urn:sha384:cnExsCH79unfP78KC-tj1JbXBwe0bXdavoLSTOb9BX_M3RnCIimXODIPrTfmRWB-", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.002895", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:mrMjUWfERxg_xL_ptmGRekPgHP4RxcQhZuZUMnyV9s7rDnMosKvJd_ZxnBBRNVN3", "resource": {"blob": {"href": "urn:sha384:Gha9iUIVYAlPqZyHe6kbyyE3eFRcdcG6vWjfptw2ri2fNVbJbK2r4ddnVcB2Mq8u", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:10:09.132321", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:32:43.518168", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:0UV5JsbH8cXL_cSutCfPbM8VJSPZ0cxbnef7R1PvAP7YuJgswHhWwYUcD2mH8M8E", "resource": {"sides": {"array": [{"href": "urn:sha384:DUTP2S0yqwUKmi9EYC6om8zkbqUjfqJcXJkJuaQeTTB4ieuo2nvgW39vz3kDoRLV", "resource": {"phrase": {"text": "Es la hija."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:4RwVfElYuKTyi4FzavQ_64LSv666dDDxQ6HTe6CfO3bTwd0hiwHQEsznoG6XQGlv", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/38872730@N00/"}, "author": {"text": "Ronald Tagra (kamsky)"}, "original_url": {"href": "http://www.flickr.com/photos/38872730@N00/7432880868"}, "title": {"text": "Happy Girl"}}, "blob": {"href": "urn:sha384:c5IiI2oAWWNVwTKgDHLht2oxPrIgfHCtByPJNZ45rR_ldmmGIkenz_D4qaM6PgAf", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.073445", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:1mQCdQeV0Ir-24AX529T3E3JRoqz4PMSYI7gC_Fc-LqRr1Wyw0pO6FMF6PbpQQDF", "resource": {"blob": {"href": "urn:sha384:YxhPs7RwnTM41MaV9j45CsAUflRL2-kzOMun5GibW36Yz0mY1fFTJqdjuToJlCKC", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:37:13.664582", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:37:17.139335", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:jYA1B0Mr4KKv_5ayUVS4NGJbHz76PnMG5iw8c1sf54WCl6ztRhJ83v-tRM96rIUw", "resource": {"sides": {"array": [{"href": "urn:sha384:RKztCj1DBpz7KklpWgdilKelzpYcoiNziGNohsCm78z_bS_yYxYxdUdZ_VEsqNqq", "resource": {"phrase": {"text": "Es la mam\u00e1."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:Otq27XdSFH2Z-LOREgp_jD8CniFoaMSCnUV-hVw3GeOtjSQsO3JuedKY9ngnj_MD", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/7466314@N05/"}, "author": {"text": "Toshimasa Ishibashi (iandeth)"}, "original_url": {"href": "http://www.flickr.com/photos/7466314@N05/1701537656"}, "title": {"text": "mother and baby"}}, "blob": {"href": "urn:sha384:N6mYN_Oqh06wqepN4kQJ2TYRBFJR87RVFY-brCivGOUNh64ag5R9GUSWhLTzi31s", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "changed mother pic"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-18T20:07:38.014166", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:m4_v8fiRTPOsd5MpnX8eLHkNhMZ0ShGg2eJwZMBw7ggGFEUrV9OyA6c2wAYPm8nq", "resource": {"blob": {"href": "urn:sha384:X49871qjxMwbAhTKPcaHgO0KVPbtDmr_0I9cXga24K3HA-uhrqimmUEq0Xy0wj-d", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:38:48.849945", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "changed mother pic"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T20:07:38.023176", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:4f0dkVR0nclx5-JLvuXwGpHwUgknTP0XmFm9QHC6tPUcSJqCMOwojRkKtb-PUIz-", "resource": {"sides": {"array": [{"href": "urn:sha384:YnXnH5-dzXJKx2oanfGPDBJwkpLrXO9e5KSCUqaaegnwsxGiemdEzeDBsgRnJi-P", "resource": {"phrase": {"text": "Es el pap\u00e1."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:surc6efU-JZ1mc7tPcfS1IOSIx2NWnNuLuPasbr4U2b-Q0cBh6a3InToVqGv6ZCS", "resource": {"credit": {}, "blob": {"href": "urn:sha384:jCJ-tIrVa7H6AU0yy9WVUCsY3KYdZcQgeXMwcsRo8SPr3pVl-SomME8C_G6W7jlu", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:13:40.556010", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:GmeXIAaS93ODwbfzMzRGI_AV2pRemaw4Y485k8dizZinopmEUkSXJycp3Lgqg0Lb", "resource": {"blob": {"href": "urn:sha384:sW-1_3yn7u-788ym8U2ph8Dr18eoCAecxoGQK1PS6L_bGQQ_-xUZJ88yy_bMxuYa", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:37:15.601671", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:13:40.673424", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:FjrbmvGBUmSwaDER-OZvBp_0xUZF0a852o-t_h8zR5Wt62SoguuBRt49m0wCMyQV", "resource": {"sides": {"array": [{"href": "urn:sha384:cUH6C-qiuTMvm_nTsQMPlcZOKZYVh1Tc_07Dj_1BahINLPm445uVEjalzcHrSHz9", "resource": {"phrase": {"text": "Es la mujer."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:zbOeKWb9Bs-9DqhIu6qoVeVRvVLE2TIV_ndzyV52BvQi3pMCL4ST5WKLEBQaT8D9", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/44124425616@N01/"}, "author": {"text": "Hamed Saber (Hamed Saber)"}, "original_url": {"href": "http://www.flickr.com/photos/44124425616@N01/417936161"}, "title": {"text": "I am a Persian Girl!"}}, "blob": {"href": "urn:sha384:Uo1WUWDRqwM8-0rCid-VTvPYFpmwj5DcLvNHAloantB-InhJlotCdkSxqUbNjnG_", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-18T05:13:40.705350", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:vzJPc3q52vnQGbTOkosfD-GlqQFvBix9fi8CWmuUIP8eahznD28qihkMHThj5tVj", "resource": {"blob": {"href": "urn:sha384:1V763vHzu7VnfkTere8FvcYforM1RDEbN_v9kCetEKG9G4oM5ki22-lQ_Z1N4q7F", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:03.856403", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "added some audio"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:08.412944", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:sBaanS7ZjtG7azu_YKPxGjgPW5g2xgsRhp5Ye9VCQjEs7NlPGni2luft8aCqfTlZ", "resource": {"sides": {"array": [{"href": "urn:sha384:Q5myS1mE86qYNom7EpbPTvMxGpwxDQTCgna86yJe3rHyy5pO1BlQ_O3GjsU_GW4P", "resource": {"phrase": {"text": "Es el hombre."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:SxK_8MRSAMHmQfjvUX_RiYBT-Yls_fHUPtwJ2RuBosKT-ZRYfe8mNMexNgzAsnfm", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/89934978@N00/"}, "author": {"text": "Alex Johnson (AlexJohnson)"}, "original_url": {"href": "http://www.flickr.com/photos/89934978@N00/2976892764"}, "title": {"text": "Chris Smith"}}, "blob": {"href": "urn:sha384:GvyafFxRBk9kRN9jzq46_qmEljvK5-aaeYGFtcm3Ygyym_oVwa0GoRewgC00q2q2", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-18T05:13:40.750716", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:Kyyq4sJJtQOG-NyYcWpqo13mC4go0-YpIzUwjYXHGcALSbO5ZAcnySRyShfKnepU", "resource": {"blob": {"href": "urn:sha384:LeBfsCKpJYhQm8hxe7LGNq9d3LFHBEM09rymG5qeyijySGifZoAhuAwOuwGj78Na", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:05.437920", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "added some audio"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:08.460612", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:FeaBqfht46u9wuL71JzvPcZzte5yabhbjsht1Q5URgXGvfXApCYjQijMXSaafahU", "resource": {"sides": {"array": [{"href": "urn:sha384:VA_2BcRsXnXCXpFP5RFQId4i0oCzm2QC9h8wakR-I-8sMAu2gHlVBx1q0QrgGWTv", "resource": {"phrase": {"text": "Es la ni\u00f1a."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:QupRBmU12z532x5AyF3N6C0SMYm3Vt2s2iZwWwfxaQao4jaz8hTF9gZuu-gftlNt", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/99713555@N00/"}, "author": {"text": "Wolfgang Lonien (Wolfgang Lonien)"}, "original_url": {"href": "http://www.flickr.com/photos/99713555@N00/6506314133"}, "title": {"text": "7dbpc130395-zuleikha"}}, "blob": {"href": "urn:sha384:QKGrC1TSMVIj3yrYiQzNEcgfxhM9vvVCOXJVAxurkKzlWpNr9HE-_avq6Fhle8_X", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/2.0/"}]}, "timestamp": "2013-11-18T05:13:40.820534", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:K8OcEEuo2iaQrMLbkoN_hBUk6aNLkMezRYsH7UxyGCWsI9QJsuUTh_IxHqyXSu5p", "resource": {"blob": {"href": "urn:sha384:f8lX5nJJyupIdHAtV0x_CItDrtU9bIeiiDBzBCIYHqWgzOGK3Yid447FYjIS90nU", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:06.879631", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "added some audio"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:08.485866", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:JyLuLqqB60YNF8P9CHb4n7c4TEIYVqssRyVxmQLo-0xj5VDBxQoBrunVyQXHa4qh", "resource": {"sides": {"array": [{"href": "urn:sha384:ScY5SjHedF7RKZjh3ycjVsNaMV9ribyVDH_E6k0qqB_z432p6_a-AbxV-qb0SipM", "resource": {"phrase": {"text": "Es el ni\u00f1o."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:Mwto1KD1J9ZvQayT8pw-QWmzMuP4YjnXRSjrghFlH1n-mTy6h8Qt5WP1TuAOIzbV", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/7826246@N03/"}, "author": {"text": " (Wmforo.com)"}, "original_url": {"href": "http://www.flickr.com/photos/7826246@N03/2752313716"}, "title": {"text": "SD530557"}}, "blob": {"href": "urn:sha384:JVlSC6v0j3c539FFwzH3zbTEb5BnTk-nTjYKCw-_gcNXvTZcDBfdYbl33iGjNbm6", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/2.0/"}]}, "timestamp": "2013-11-18T05:13:40.846263", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:GBX_M13dv-0byccrfOp0uU9LOIGKiZyKsOsxei58tNRo2UYytxrt6BdNS2aAOfZ-", "resource": {"blob": {"href": "urn:sha384:GbL2G80Q3DnnPm5tK_fWyrchzafWs6XOwlbE9ehW7iFOxTFoAOUU9lfBR7hsXKJV", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:08.154657", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "added some audio"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:33:08.511493", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:IFeJeL_T-IzEgzLa0dSP8cjujEua1nB0pn-ZzEf68WMyBUpl4HvcyG-9XQTVGlgA", "resource": {"sides": {"array": [{"href": "urn:sha384:7DwMqevIz49us4rkIzvpjiQj2brYs1jah5GG9BBMKSI9y5BYkGpGJUP1Kc8ljxT8", "resource": {"phrase": {"text": "Es el abuelo. "}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:K1OcvGIY-c0Vp3nf0y9ibI-rON5b3Yl6IAJpwDzU0pMqD99jqW0SW6C1gGNq_r_R", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/50852241@N00/"}, "author": {"text": "David Dennis (DavidDennisPhotos.com)"}, "original_url": {"href": "http://www.flickr.com/photos/50852241@N00/87710908"}, "title": {"text": "Man at Momos Restaurant"}}, "blob": {"href": "urn:sha384:VzGcOUtfh16XqFKDnhSA-8djOGrAmmB2UTFRJ45FdwSUUFQKlT85dkAFU0paqjmX", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.239985", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:tNrgvxf_wc3nY4bYznWz2DS0wullLofBoYg7Na_N32ABYKXpAOVU74MemofKMcLp", "resource": {"blob": {"href": "urn:sha384:z072Ux15HNAGc70VVdYpXUHpiB0XHkSvasdzf4yYcnby3DoLliyFXYaeDBgDjFGZ", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:37:16.962723", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:37:17.183716", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:JGP9GnNa9nxytE6fjkM69vsbjOwXYGYE_C-5-wIGZV4hQKlA41kb6VXZEiMJidK1", "resource": {"sides": {"array": [{"href": "urn:sha384:rtBOB7OSyG5rHBp2NfKdjtzzwpo_crMQpf5E-NVakb78HHyjRE59dU2fyQtYlFR8", "resource": {"phrase": {"text": "Es la abuela."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:DLXsjkb0S5w6JoY0avybDH7gFjdaDOE_bPZupqafIiqEd2jH7R6BP11qqnOFE--C", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/92181839@N00/"}, "author": {"text": " (sabertasche2)"}, "original_url": {"href": "http://www.flickr.com/photos/92181839@N00/4101160357"}, "title": {"text": "Grandma"}}, "blob": {"href": "urn:sha384:ggViO_VZDccwCHoOYs-CWdLDt9prkzUWvAXTV2xxJt-AFAhnHNr605kQT_I-7-aQ", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.337179", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:3q_HSj6rpHVH6F_q4hJTgvfTKHNg36g17r-UZ3vGKi1hnXvZ5JfMjnAbUyuGjgDR", "resource": {"blob": {"href": "urn:sha384:Z3SwC5eBbiqPD3qnW4KF0DaX7WXXZMziWqaHjf-10nwTcVAOMHv20ixEWS1_UMiX", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:38:50.411203", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:38:54.348184", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:9-8-enUMxDo2U7NfZInnBWrTLlepd-OWkf5w1Zp1U7AxC0QejrLlwUTb3t30Jr8t", "resource": {"sides": {"array": [{"href": "urn:sha384:i2okT4HodBHJCzUxE04rqOiMPj9vGf0wFGx_QdBRnS6-ubvUq7clnmbb2i2Q4MxK", "resource": {"phrase": {"text": "Es la familia."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:3US38N0Q7zjjc2T4tvu5SAl1rnGkECWK_urYYph_O0DZ7lSz_weMtottTGuPVuqQ", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/88562024@N00/"}, "author": {"text": "Rob Boudon (Rob Boudon)"}, "original_url": {"href": "http://www.flickr.com/photos/88562024@N00/1143726319"}, "title": {"text": "Grandma"}}, "blob": {"href": "urn:sha384:7ORgCkuPmSsZ_gkQyZrDlx7aSduqD7JhFdefxHAamAM4ZTb06aaw55kJfb1vFlmp", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.397066", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:R9B3CMfYhsQza24KCVYTyMX--44w7FKDWij8ZwsdLCwXi_mEYr5gVANCzKY-2y_P", "resource": {"blob": {"href": "urn:sha384:JomCvkXfICHA68RfZ4N4gEUqv5R0VnjB5iP-Zq7hAm0ZUFLabwpn4bw4mDnnryA5", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-19T00:34:16.052605", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-19T00:34:16.468936", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:wuROKlmJ2IQAkuJwFha63NwhfstRU-EQyBySMDEIS-JxtkHDZVZWUY5KcFnfrvXE", "resource": {"sides": {"array": [{"href": "urn:sha384:-HUtAO_bDWJSSTt2wtbBbFNjG366xvlMrKVG_eNw-QBOolCYyv44HybAmoDJsebU", "resource": {"phrase": {"text": "Es el beb\u00e9."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:PjqIzbG98eUsh0cRD8Hd_ERevWveh8DnFa1Pz-klDVmx4V-S8gduixKgZFJ0Ot1b", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/26315381@N06/"}, "author": {"text": "Kim Str\u00f8mstad (barekim)"}, "original_url": {"href": "http://www.flickr.com/photos/26315381@N06/3403494667"}, "title": {"text": "Angry kid"}}, "blob": {"href": "urn:sha384:jn8sEvpmPp1rBESCy797ox5VlNyip_oJ4c68IZlmHGg4euDv_SJiYa6WAqAF7BVr", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-18T05:13:40.917290", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "", "resource": null}]}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:13:40.943605", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:9RI5ARUKMyL_dSO7AV4oj7xKIVGBGQJM4WU7LTxiiAKaYOF39HnZUlRhw-nS76ac", "resource": {"sides": {"array": [{"href": "urn:sha384:Sa3SB-TUTDC1bC4JEw01J6eCFa_9KZCUgibVgiq_UAKn4IE6wYveKGmsMsTEMgeU", "resource": {"phrase": {"text": "Son hermanos."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:rry8_UXTfDXONYE6t9GdrOLp4MquIfEex1-KjP2ub01M-judl61_PS1yGlDMlV9k", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/12567713@N00/"}, "author": {"text": " (born1945)"}, "original_url": {"href": "http://www.flickr.com/photos/12567713@N00/214221566"}, "title": {"text": "Brothers"}}, "blob": {"href": "urn:sha384:Q9vHHq2JgVDtg8DNeYfAG44OTNH5HSC385KHDtLWpeKZYFOrhCn592tjQHIHa6_7", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.430376", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:mkYRAysOt29uG_mXqUT4Dus8cDF_v4KWu_q6TDM5KXNr-SOmZoG_BYgex2XaGZad", "resource": {"blob": {"href": "urn:sha384:ZzMtY1z-QVmnDGQFvuxmh80CqCuJooz_EFsqIpIoY6OzC34N4Q3ajQ4r6HjShDwz", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:38:54.140942", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:38:54.379962", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:CU0RtOzvIqyyJKhsp8nlSPzqG4B_QG60Q6X9_T69TS8fkeBEiRL3oKXs7WARv1g1", "resource": {"sides": {"array": [{"href": "urn:sha384:xrsQDAFSsUkFvaEsE_bXQ-tbz_8J0EaDTbn6YZA9_i2aD6claw3w20pFT2di7qel", "resource": {"phrase": {"text": "Son hermanas."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:vonHxclp7vbjfdXw9q02ANk8xREELGW60aepTeEyKM8e4uulrWvBR9ZDHyC0VJXL", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/7961775@N03/"}, "author": {"text": "Steve Hankins (hankinsphoto.com)"}, "original_url": {"href": "http://www.flickr.com/photos/7961775@N03/7419866148"}, "title": {"text": "Sisters"}}, "blob": {"href": "urn:sha384:OtYrz9Xs0jaKlI0lbH9ReXt1zRtrDdQkkKdEvI_1Acp6C_dPfw5UJOU0tS_Tp97W", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.498117", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:YF5AC4gNLmd7nCvdvQVLhotvj0Rd_KIO_JtNV55OpKzBhZ2pxH84NuUrh7lNr5Cd", "resource": {"blob": {"href": "urn:sha384:0o86BVyb-lxaETxIp1mvNO15zIBlwvzevyH2B5mchfwVz70wiOXG2ppg3bpy9ush", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:41:08.147743", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:41:14.553996", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:Vfpmnao0HWJWc82R_p0Bbe9QE0TTdH-4EfLZzYsen8PjIdY-imK2ZxGWTHmDhTSJ", "resource": {"sides": {"array": [{"href": "urn:sha384:DRF8lcYG9ZclwH1bxYbYUnyR2UUj9j5C5Qjx_RI6hOrMFKe_K5_5H7-W8mYkMrHf", "resource": {"phrase": {"text": "El pap\u00e1 est\u00e1 con su hijo."}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:blDClF3fGhOgOkD7UKqVFTeke-JE8taVcbOFvoL12OnQN7HkuNGteJmW2yCu0pVK", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/53779476@N08/"}, "author": {"text": "Bart Speelman (Jeda Villa Bali)"}, "original_url": {"href": "http://www.flickr.com/photos/53779476@N08/5011303336"}, "title": {"text": "Father_Child"}}, "blob": {"href": "urn:sha384:CSBhAgNcIeatZDalfVYU_O9TUjZD67J9975UWAoOn82BMhfjUApi9erEKrgldjFH", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.541832", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:v8XGyxIqKyVzFRLuy0JoFJ3_Hkmne1PL8F71-T6wL0_t0YOojjGcVFs3PLvFr5t3", "resource": {"blob": {"href": "urn:sha384:5aRrrJrHONdqi6Hb7x5LFtjeWbKU9LRNnxIVgv52ycbWyGTK7iU370gZN6dsPenD", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:41:10.265193", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:13:40.969586", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}, {"href": "urn:sha384:-AtdtR40Do_3KFPg_3xCVcPTlsYc3ikXbqPbVJZ5l_C0lWNm7t_tUc8pMlyjhN_v", "resource": {"sides": {"array": [{"href": "urn:sha384:Sq895KhyhCWK9bXXNS4lnLBKpR8oaTPFFOl3gb17KpL4lOF7M5b4u3sDS3PxLWU4", "resource": {"phrase": {"text": "La mam\u00e1 est\u00e1 con su hija. "}, "fqn": "{http://wikiotics.org/ns/2011/phrase}phrase"}}, {"href": "urn:sha384:MPDp02pENs2Q4OCQlVTQ9-DZNFB81EGSvEncPW5cKRbxGKPZvFTJ3leGg-W_LPOE", "resource": {"credit": {"author_url": {"href": "http://www.flickr.com/people/36558296@N00/"}, "author": {"text": "United Pentecostal Church (pentecostalsofoc)"}, "original_url": {"href": "http://www.flickr.com/photos/36558296@N00/7479730950"}, "title": {"text": "Fathers Day 2012"}}, "blob": {"href": "urn:sha384:JGPmvhFzSX2vOJ14VEMXpIu2Hwgjdv9E5KxmCMOSZMGYhl2hot-rbKUyTi_rp8vq", "mime_type": "image/jpeg"}, "common": {"log_message": {"text": "Added a number of different family related pictures"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by/2.0/"}]}, "timestamp": "2013-11-17T16:04:39.568286", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2009/picture}picture"}}, {"href": "urn:sha384:9Rt4vh9QaWaP4i-dLR9aM9SVHLBYakCljsLdl76tAGn-e1tV96MmKiiZ3p1R1SSH", "resource": {"blob": {"href": "urn:sha384:icMEgTUgqKncvBRWv6C-sjhfFhOBHptYmF7zC238aPYRDy9M5ptLNigvCnPx6yLP", "mime_type": "audio/ogg"}, "common": {"log_message": {"text": ""}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-17T16:41:12.240949", "author": {"text": "98.116.20.243", "href": ""}}, "fqn": "{http://wikiotics.org/ns/2010/audio}audio"}}]}, "common": {"log_message": {"text": "changed papa pic, added group"}, "licenses": {"array": [{"href": "http://creativecommons.org/licenses/by-sa/3.0/"}]}, "timestamp": "2013-11-18T05:13:40.995106", "author": {"text": "mxc", "href": "http://wikiotics.org/user/mxc"}}, "fqn": "{http://wikiotics.org/ns/2011/flashcards}flashcard"}}]}};

var PictureChoiceElement = React.createClass({
    render: function() {
        var elt = this.props.elt;
        if (elt.type == "phrase") {
            return <div>{elt.phrase}</div>;
        } else if (elt.type == "picture") {
            return <div><img src={elt.url}/></div>;
        } else if (elt.type == "audio") {
            return <div className="btn btn-default"><i className="fa fa-play"></i>&nbsp; (audio)</div>;
        } else {
            return <div/>;
        }
    }
});

var PictureChoiceSubframe = React.createClass({
    render: function() {
        var data = this.props.data;
        return (
            <div className={this.props.grayed ? "grayed" : ""}>
              {data.map(function(elt, i) {
                  return <PictureChoiceElement elt={elt} key={i}/>;
              })}
            </div>
        );
    }
});

var PictureChoiceFrame = React.createClass({
    getInitialState: function() {
        return {
            grayed: this.props.data.choices.map(function() { return false; }),
            complete: false
        };
    },
    handleClick: function(i) {
        var self = this;
        return function(e) {
            e.preventDefault();
            if (self.state.complete || self.state.grayed[i]) return;
            var correct = (i == self.props.data.answer);
            if (correct) {
                self.setState({
                    grayed: null,
                    complete: true
                });
                setTimeout(function() {
                    self.props.onFrameComplete();
                }, 3000);
            } else {
                var grayed = self.state.grayed.slice(0);
                grayed[i] = true;
                self.setState({grayed: grayed});
            }
        };
    },
    render: function() {
        if (this.state.complete) {
            return (
                <div>
                  <PictureChoiceSubframe data={this.props.data.prompt} />
                  <table>
                    <tbody>
                      <tr>
                        <td><PictureChoiceSubframe data={this.props.data.choices[this.props.data.answer]} grayed={false} /></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
            );
        }
        return (
            <div>
              <PictureChoiceSubframe data={this.props.data.prompt} />
              <table>
                <tbody>
                  <tr>
                    <td onClick={this.handleClick(0)}><PictureChoiceSubframe data={this.props.data.choices[0]} grayed={this.state.grayed[0]} /></td>
                    <td onClick={this.handleClick(1)}><PictureChoiceSubframe data={this.props.data.choices[1]} grayed={this.state.grayed[1]} /></td>
                  </tr>
                  <tr>
                    <td onClick={this.handleClick(2)}><PictureChoiceSubframe data={this.props.data.choices[2]} grayed={this.state.grayed[2]} /></td>
                    <td onClick={this.handleClick(3)}><PictureChoiceSubframe data={this.props.data.choices[3]} grayed={this.state.grayed[3]} /></td>
                  </tr>
                </tbody>
              </table>
            </div>
        );
    }
});

var PictureChoiceStatus = React.createClass({
    render: function() {
        if (this.props.done) {
            return (
                <div>
                  All done!
                </div>
            );
        } else {
            return (
                <div>
                  Frame {this.props.frame + 1} of {this.props.nframes}.
                </div>
            );
        }
    }
});

var PictureChoiceLesson = React.createClass({
    getInitialState: function() {
        return {frame: 0, done: (this.props.frames.length == 0)};
    },
    handleFrameComplete: function() {
        this.setState({
            frame: this.state.frame + 1,
            done: (this.state.frame + 1 == this.props.frames.length)
        });
    },
    render: function() {
        if (this.state.done) {
            return (
                <div>
                  <PictureChoiceStatus done={true} />
                </div>
            );
        } else {
            return (
                <div>
                  <PictureChoiceFrame onFrameComplete={this.handleFrameComplete} data={this.props.frames[this.state.frame]} key={this.state.frame} />
                  <PictureChoiceStatus frame={this.state.frame} nframes={this.props.frames.length} />
                </div>
            );
        }
    }
});

function resolve_urn(urn) {
    return 'https://wikiotics.org/' + urn.split(':').join('/');
}

// simplify the really verbose resource_json representation
function transform1(resource_json) {
    if (resource_json.fqn != "{http://wikiotics.org/ns/2011/flashcards}flashcard_deck") {
        // FIXME: error out
        alert("error");
        return;
    }
    var interaction_idx = 0, // by default
        interaction = resource_json.interactions.array[interaction_idx].resource;
    if (interaction.fqn != "{http://wikiotics.org/ns/2011/flashcards}choice_interaction") {
        // FIXME: error out
        alert("error");
        return;
    }
    var prompt_columns = interaction.prompt.split(","),
        answer_columns = interaction.answer.split(","),
        dividers = resource_json.dividers.split(",");
    var _cards = resource_json.cards.array;
    var cards = [], sides;
    var i, e_i, j, e_j, _sides, _side, _href;
    for (i = 0, e_i = _cards.length; i < e_i; ++i) {
        _sides = _cards[i].resource.sides.array;
        sides = [];
        for (j = 0, e_j = _sides.length; j < e_j; ++j) {
            _href = _sides[j].href;
            _side = _sides[j].resource;
            if (_side == null) {
                sides.push({type: "null"});
            } else if (_side.fqn == "{http://wikiotics.org/ns/2011/phrase}phrase") {
                sides.push({type: "phrase", phrase: _side.phrase.text});
            } else if (_side.fqn == "{http://wikiotics.org/ns/2009/picture}picture") {
                sides.push({type: "picture", url: resolve_urn(_href) + "?view=image&max_size=250,250"});
            } else if (_side.fqn == "{http://wikiotics.org/ns/2010/audio}audio") {
                sides.push({type: "audio", url: resolve_urn(_href) + "?view=audio"});
            } else {
                sides.push({type: "unknown"});
            }
        }
        cards.push(sides);
    }
    return {
        dividers: dividers,
        prompt_columns: prompt_columns,
        answer_columns: answer_columns,
        cards: cards
    }
}

function somefunc(sides, cols) {
    var i, e, rv = [];
    for (i = 0, e = cols.length; i < e; ++i) {
        rv.push(sides[cols[i]]);
    }
    return rv;
}

// compile it into a lesson run-through
function transform2(resource) {
    var prompt_columns = resource.prompt_columns,
        answer_columns = resource.answer_columns,
        cards = resource.cards,
        dividers = resource.dividers.slice(0); // i.e. clone it first
    dividers.unshift(0);
    dividers.push(cards.length);

    // FIXME: possibly do some assertions on the order of dividers

    var frames = [];
    var i, e, j, e_j, k, e_k, begin, end, indices, idx, choices, choices_out, answer;
    for (i = 0, e = dividers.length - 1; i < e; ++i) {
        begin = dividers[i];
        end = dividers[i + 1];
        indices = [];
        for (j = begin; j < end; ++j) {
            indices.push(j);
        }
        shuffle(indices);
        for (j = 0, e_j = indices.length; j < e_j; ++j) {
            idx = indices[j];
            choices = [];
            for (k = begin; k < end; ++k) {
                if (k != idx) {
                    choices.push(k);
                }
            }
            choices = shuffle.pick(choices, {picks: Math.max(3, choices.length)});
            answer = Math.floor(Math.random() * (choices.length + 1));
            choices.splice(answer, 0, idx);
            choices = choices.map(function(ck) {
                return somefunc(cards[ck], answer_columns);
            });
            frames.push({
                prompt: somefunc(cards[idx], prompt_columns),
                choices: choices,
                answer: answer
            });
        }
    }
    return frames;
}

var PictureChoiceApp = React.createClass({
    render: function() {
        return (
            <div className="container">
              <PictureChoiceLesson frames={transform2(transform1(resource_json))} />
            </div>
        );
    }
});

ReactDOM.render(<PictureChoiceApp />, document.getElementById("app"));
